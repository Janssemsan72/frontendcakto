<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Musiclovely - Crie músicas personalizadas para quem você ama</title>
    
    <!-- ✅ Open Graph / Facebook / WhatsApp -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://www.musiclovely.com.br/" />
    <meta property="og:title" content="Musiclovely - Crie músicas personalizadas para quem você ama" />
    <meta property="og:description" content="Transforme memórias em música! Crie uma música única e personalizada para quem você ama. Plataforma #1 de músicas personalizadas no Brasil." />
    <meta property="og:image" content="https://www.musiclovely.com.br/og/musiclovely-og-1200x630.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Musiclovely - Músicas personalizadas" />
    <meta property="og:locale" content="pt_BR" />
    <meta property="og:site_name" content="Musiclovely" />
    
    <!-- ✅ Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content="https://www.musiclovely.com.br/" />
    <meta name="twitter:title" content="Musiclovely - Crie músicas personalizadas para quem você ama" />
    <meta name="twitter:description" content="Transforme memórias em música! Crie uma música única e personalizada para quem você ama. Plataforma #1 de músicas personalizadas no Brasil." />
    <meta name="twitter:image" content="https://www.musiclovely.com.br/og/musiclovely-og-1200x630.png" />
    <meta name="twitter:image:alt" content="Musiclovely - Músicas personalizadas" />
    
    <!-- ✅ Meta tags adicionais -->
    <meta name="description" content="Transforme memórias em música! Crie uma música única e personalizada para quem você ama. Plataforma #1 de músicas personalizadas no Brasil." />
    <meta name="keywords" content="música personalizada, música para presente, música única, música sob medida, presente criativo, música para aniversário" />
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
    <meta name="googlebot" content="index, follow" />
    <meta name="author" content="Musiclovely" />
    <meta name="theme-color" content="#C7916B" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Musiclovely" />
    <link rel="canonical" href="https://www.musiclovely.com.br/" />
    <link rel="alternate" hreflang="pt-BR" href="https://www.musiclovely.com.br/" />
    
    <!-- ✅ Structured Data (JSON-LD) para SEO otimizado -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Musiclovely",
      "url": "https://www.musiclovely.com.br",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.musiclovely.com.br/logo-white-new.png",
        "width": 512,
        "height": 512
      },
      "description": "Plataforma #1 de músicas personalizadas no Brasil. Transforme memórias em música única para quem você ama.",
      "foundingDate": "2023",
      "contactPoint": {
        "@type": "ContactPoint",
        "contactType": "customer service",
        "availableLanguage": ["Portuguese", "pt-BR"]
      },
      "sameAs": [],
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "100+"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Musiclovely",
      "url": "https://www.musiclovely.com.br",
      "description": "Transforme memórias em música! Crie uma música única e personalizada para quem você ama.",
      "inLanguage": "pt-BR",
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://www.musiclovely.com.br/?s={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Service",
      "serviceType": "Música Personalizada",
      "provider": {
        "@type": "Organization",
        "name": "Musiclovely",
        "url": "https://www.musiclovely.com.br"
      },
      "areaServed": {
        "@type": "Country",
        "name": "Brasil"
      },
      "availableChannel": {
        "@type": "ServiceChannel",
        "serviceUrl": "https://www.musiclovely.com.br/quiz",
        "serviceName": "Criar Música Personalizada"
      },
      "description": "Criação de músicas personalizadas e únicas para presentes especiais, aniversários, casamentos e momentos especiais",
      "offers": {
        "@type": "Offer",
        "priceCurrency": "BRL",
        "availability": "https://schema.org/InStock"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Início",
        "item": "https://www.musiclovely.com.br/"
      }]
    }
    </script>
    
    <!-- ✅ OTIMIZAÇÃO: Preconnect para recursos críticos PRIMEIRO (mais importante) -->
    <link rel="preconnect" href="https://zagkvtxarndluusiluhb.supabase.co" crossorigin />
    <link rel="preconnect" href="https://pay.cakto.com.br" crossorigin />
    
    <!-- ✅ FASE 2: Preconnect para Utmify e Facebook (críticos para tracking) -->
    <link rel="preconnect" href="https://cdn.utmify.com.br" crossorigin />
    <link rel="preconnect" href="https://connect.facebook.net" crossorigin />
    
    <!-- ✅ OTIMIZAÇÃO: DNS prefetch para domínios de terceiros (menos críticos) -->
    <link rel="dns-prefetch" href="https://analytics.tiktok.com" />
    <link rel="dns-prefetch" href="https://pay.cakto.com.br" />
    <link rel="dns-prefetch" href="https://randomuser.me" />

    <!-- ✅ UTMify/Facebook Pixel: não carregar em /admin (evita erro _id undefined no pixel.js) -->
    <script>
      window.pixelId = "68f98a3f196fbe7f0e5683c7";
      (function() {
        var path = (window.location.pathname || '');
        var hostname = (window.location.hostname || '').toLowerCase();
        if (path.indexOf('/admin') === 0 || path.indexOf('/app/admin') === 0) return;
        if (hostname === 'localhost' || hostname === '127.0.0.1') return;
        var a = document.createElement("script");
        a.async = true;
        a.src = "https://cdn.utmify.com.br/scripts/pixel/pixel.js";
        a.onerror = function() { try { console.warn('[Pixel] Erro ao carregar'); } catch(e) {} };
        (document.head || document.documentElement).appendChild(a);
        var b = document.createElement("script");
        b.async = true;
        b.defer = true;
        b.src = "https://cdn.utmify.com.br/scripts/utms/latest.js";
        b.setAttribute("data-utmify-prevent-subids", "");
        (document.head || document.documentElement).appendChild(b);
      })();
    </script>
    
    <!-- ✅ Logo no header: preload para aparecer instantaneamente -->
    <link rel="preload" as="image" href="/images/logo-white.png" fetchpriority="high" />
    <!-- ✅ OTIMIZAÇÃO LCP: Preload da imagem LCP com fetchpriority high -->
    <link
      rel="preload"
      as="image"
      href="/images/collage-memories-new.webp"
      type="image/webp"
      fetchpriority="high"
      imagesizes="(max-width: 640px) 384px, (max-width: 1024px) 640px, 1024px"
    />
    
    <!-- ✅ OTIMIZAÇÃO PERFORMANCE: Script principal com defer para não bloquear parsing -->
    <!-- ✅ CORREÇÃO CRÍTICA: Script principal deve estar no HTML para o Vite processar -->
    <!-- ✅ CORREÇÃO PRODUÇÃO: Vite injeta automaticamente em produção, este script só é necessário em dev -->
    <!-- Em produção, o Vite substitui este script pelo bundle otimizado -->
    <script type="module" src="/src/main.tsx" defer></script>
    
    <!-- ✅ OTIMIZAÇÃO: CSS crítico mínimo inline para FCP rápido - Apenas above-the-fold -->
    <style>
      /* CSS Crítico Mínimo - Above the Fold - Otimizado para Performance */
      *{margin:0;padding:0;box-sizing:border-box}
      html{font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif;font-display:swap;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;text-rendering:optimizeSpeed}
      body{color:#1a1a1a;background:#fff;line-height:1.5;margin:0;overflow-x:hidden}
      #root{min-height:100vh;display:flex;flex-direction:column}
      /* Posicionamento crítico para hero */
      .relative{position:relative}
      .absolute{position:absolute}
      .inset-0{top:0;right:0;bottom:0;left:0}
      .w-full{width:100%}
      .h-full{height:100%}
      /* Imagens e vídeo críticos */
      img,video{max-width:100%;height:auto;display:block}
      img[width][height]{aspect-ratio:attr(width)/attr(height)}
      .object-cover{object-fit:cover;object-position:center}
      /* Header crítico */
      header{position:fixed;top:0;left:0;right:0;z-index:50;background:#fff;border-bottom:1px solid rgba(0,0,0,0.1)}
      /* Hero section crítico - CLS prevention */
      .hero-image-container{aspect-ratio:640/269;min-height:calc((100vw - 1.5rem) * 269 / 640);background-color:#E7D5C4}
      @media(min-width:640px){.hero-image-container{min-height:calc((640px - 2rem) * 269 / 640)}}
      @media(min-width:768px){.hero-image-container{min-height:calc((768px - 5rem) * 269 / 640)}}
      /* Layout crítico */
      .overflow-hidden{overflow:hidden}
      .rounded-2xl{border-radius:1rem}
      .text-center{text-align:center}
      .mx-auto{margin-left:auto;margin-right:auto}
      /* Botão CTA crítico */
      button{display:inline-flex;align-items:center;justify-content:center;border-radius:1rem;font-weight:500;cursor:pointer;border:none}
      .bg-primary{background-color:#C7916B}
      .text-white{color:#fff}
    </style>
    
    <!-- ✅ OTIMIZAÇÃO: CSS carregado de forma não-bloqueante (defer total) -->
    <link rel="preload" href="/src/index.css" as="style" />
    <link rel="stylesheet" href="/src/index.css" media="print" onload="this.media='all';this.onload=null" />
    <noscript><link rel="stylesheet" href="/src/index.css" /></noscript>
    <script>
      // Fallback otimizado - timeout reduzido para 25ms
      (function() {
        var link = document.querySelector('link[href="/src/index.css"]');
        if (link && link.media === 'print') {
          var fallback = setTimeout(function() {
            if (link.media === 'print') {
              link.media = 'all';
            }
          }, 25);
          if (link.onload) {
            var originalOnload = link.onload;
            link.onload = function() {
              clearTimeout(fallback);
              if (originalOnload) originalOnload.call(this);
              this.onload = null;
            };
          }
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <!-- ✅ OTIMIZAÇÃO: Script principal será injetado pelo Vite durante o build -->
    
    <!-- ✅ CORREÇÃO META PIXEL: Noscript fallback (deve estar no body, não no head) -->
    <noscript>
      <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=68f98a3f196fbe7f0e5683c7&ev=PageView&noscript=1"/>
    </noscript>
    
    <!-- ✅ CORREÇÃO: Script simplificado para apenas limpar ?nocache da URL -->
    <script>
      (function() {
        // ✅ CORREÇÃO: Apenas remover ?nocache da URL se existir, sem fazer mais nada
        // Não detectar erros, não forçar reloads, apenas limpar a URL
        const currentUrl = window.location.href;
        if (currentUrl.includes('?nocache=')) {
          const cleanUrl = currentUrl.split('?')[0].split('#')[0];
          window.history.replaceState({}, '', cleanUrl);
        }
        
        // Limpar contadores de reload antigos do sessionStorage
        try {
          sessionStorage.removeItem('cache_fix_reload_count');
          sessionStorage.removeItem('cache_fix_last_reload');
        } catch (e) {
          // Ignorar se sessionStorage não estiver disponível
        }
        // Remover shell do header quando React estiver pronto
        var onReactReady = function() {
          var shell = document.getElementById('ml-header-shell');
          if (shell) shell.remove();
        };
        if (window.__REACT_READY__) onReactReady();
        else window.addEventListener('react-ready', onReactReady, { once: true });
      })();
    </script>
  </body>
</html>
